(()=>{var Ht=Object.create;var ge=Object.defineProperty,Gt=Object.defineProperties,It=Object.getOwnPropertyDescriptor,Wt=Object.getOwnPropertyDescriptors,zt=Object.getOwnPropertyNames,ee=Object.getOwnPropertySymbols,Vt=Object.getPrototypeOf,ve=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var De=(e,t,r)=>t in e?ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,H=(e,t)=>{for(var r in t||(t={}))ve.call(t,r)&&De(e,r,t[r]);if(ee)for(var r of ee(t))Re.call(t,r)&&De(e,r,t[r]);return e},Be=(e,t)=>Gt(e,Wt(t));var Ne=(e,t)=>{var r={};for(var n in e)ve.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&ee)for(var n of ee(e))t.indexOf(n)<0&&Re.call(e,n)&&(r[n]=e[n]);return r};var R=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Yt=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of zt(t))!ve.call(e,s)&&s!==r&&ge(e,s,{get:()=>t[s],enumerable:!(n=It(t,s))||n.enumerable});return e};var Jt=(e,t,r)=>(r=e!=null?Ht(Vt(e)):{},Yt(t||!e||!e.__esModule?ge(r,"default",{value:e,enumerable:!0}):r,e));var $=(e,t,r)=>new Promise((n,s)=>{var o=f=>{try{m(r.next(f))}catch(F){s(F)}},d=f=>{try{m(r.throw(f))}catch(F){s(F)}},m=f=>f.done?n(f.value):Promise.resolve(f.value).then(o,d);m((r=r.apply(e,t)).next())});var dt=R(($r,Fe)=>{var ke=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n,s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",d=s.asyncIterator||"@@asyncIterator",m=s.toStringTag||"@@toStringTag";function f(c,a,u){return Object.defineProperty(c,a,{value:u,enumerable:!0,configurable:!0,writable:!0}),c[a]}try{f({},"")}catch(c){f=function(a,u,y){return a[u]=y}}function F(c,a,u,y){var h=a&&a.prototype instanceof L?a:L,A=Object.create(h.prototype),O=new de(y||[]);return A._invoke=B(c,u,O),A}e.wrap=F;function i(c,a,u){try{return{type:"normal",arg:c.call(a,u)}}catch(y){return{type:"throw",arg:y}}}var E="suspendedStart",v="suspendedYield",p="executing",b="completed",x={};function L(){}function S(){}function P(){}var U={};f(U,o,function(){return this});var _=Object.getPrototypeOf,k=_&&_(_(me([])));k&&k!==t&&r.call(k,o)&&(U=k);var g=P.prototype=L.prototype=Object.create(U);S.prototype=P,f(g,"constructor",P),f(P,"constructor",S),S.displayName=f(P,m,"GeneratorFunction");function j(c){["next","throw","return"].forEach(function(a){f(c,a,function(u){return this._invoke(a,u)})})}e.isGeneratorFunction=function(c){var a=typeof c=="function"&&c.constructor;return a?a===S||(a.displayName||a.name)==="GeneratorFunction":!1},e.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,P):(c.__proto__=P,f(c,m,"GeneratorFunction")),c.prototype=Object.create(g),c},e.awrap=function(c){return{__await:c}};function C(c,a){function u(A,O,T,N){var D=i(c[A],c,O);if(D.type==="throw")N(D.arg);else{var he=D.arg,K=he.value;return K&&typeof K=="object"&&r.call(K,"__await")?a.resolve(K.__await).then(function(z){u("next",z,T,N)},function(z){u("throw",z,T,N)}):a.resolve(K).then(function(z){he.value=z,T(he)},function(z){return u("throw",z,T,N)})}}var y;function h(A,O){function T(){return new a(function(N,D){u(A,O,N,D)})}return y=y?y.then(T,T):T()}this._invoke=h}j(C.prototype),f(C.prototype,d,function(){return this}),e.AsyncIterator=C,e.async=function(c,a,u,y,h){h===void 0&&(h=Promise);var A=new C(F(c,a,u,y),h);return e.isGeneratorFunction(a)?A:A.next().then(function(O){return O.done?O.value:A.next()})};function B(c,a,u){var y=E;return function(A,O){if(y===p)throw new Error("Generator is already running");if(y===b){if(A==="throw")throw O;return Te()}for(u.method=A,u.arg=O;;){var T=u.delegate;if(T){var N=I(T,u);if(N){if(N===x)continue;return N}}if(u.method==="next")u.sent=u._sent=u.arg;else if(u.method==="throw"){if(y===E)throw y=b,u.arg;u.dispatchException(u.arg)}else u.method==="return"&&u.abrupt("return",u.arg);y=p;var D=i(c,a,u);if(D.type==="normal"){if(y=u.done?b:v,D.arg===x)continue;return{value:D.arg,done:u.done}}else D.type==="throw"&&(y=b,u.method="throw",u.arg=D.arg)}}}function I(c,a){var u=c.iterator[a.method];if(u===n){if(a.delegate=null,a.method==="throw"){if(c.iterator.return&&(a.method="return",a.arg=n,I(c,a),a.method==="throw"))return x;a.method="throw",a.arg=new TypeError("The iterator does not provide a 'throw' method")}return x}var y=i(u,c.iterator,a.arg);if(y.type==="throw")return a.method="throw",a.arg=y.arg,a.delegate=null,x;var h=y.arg;if(!h)return a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,x;if(h.done)a[c.resultName]=h.value,a.next=c.nextLoc,a.method!=="return"&&(a.method="next",a.arg=n);else return h;return a.delegate=null,x}j(g),f(g,m,"Generator"),f(g,o,function(){return this}),f(g,"toString",function(){return"[object Generator]"});function _e(c){var a={tryLoc:c[0]};1 in c&&(a.catchLoc=c[1]),2 in c&&(a.finallyLoc=c[2],a.afterLoc=c[3]),this.tryEntries.push(a)}function J(c){var a=c.completion||{};a.type="normal",delete a.arg,c.completion=a}function de(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(_e,this),this.reset(!0)}e.keys=function(c){var a=[];for(var u in c)a.push(u);return a.reverse(),function y(){for(;a.length;){var h=a.pop();if(h in c)return y.value=h,y.done=!1,y}return y.done=!0,y}};function me(c){if(c){var a=c[o];if(a)return a.call(c);if(typeof c.next=="function")return c;if(!isNaN(c.length)){var u=-1,y=function h(){for(;++u<c.length;)if(r.call(c,u))return h.value=c[u],h.done=!1,h;return h.value=n,h.done=!0,h};return y.next=y}}return{next:Te}}e.values=me;function Te(){return{value:n,done:!0}}return de.prototype={constructor:de,reset:function(c){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(J),!c)for(var a in this)a.charAt(0)==="t"&&r.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=n)},stop:function(){this.done=!0;var c=this.tryEntries[0],a=c.completion;if(a.type==="throw")throw a.arg;return this.rval},dispatchException:function(c){if(this.done)throw c;var a=this;function u(N,D){return A.type="throw",A.arg=c,a.next=N,D&&(a.method="next",a.arg=n),!!D}for(var y=this.tryEntries.length-1;y>=0;--y){var h=this.tryEntries[y],A=h.completion;if(h.tryLoc==="root")return u("end");if(h.tryLoc<=this.prev){var O=r.call(h,"catchLoc"),T=r.call(h,"finallyLoc");if(O&&T){if(this.prev<h.catchLoc)return u(h.catchLoc,!0);if(this.prev<h.finallyLoc)return u(h.finallyLoc)}else if(O){if(this.prev<h.catchLoc)return u(h.catchLoc,!0)}else if(T){if(this.prev<h.finallyLoc)return u(h.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(c,a){for(var u=this.tryEntries.length-1;u>=0;--u){var y=this.tryEntries[u];if(y.tryLoc<=this.prev&&r.call(y,"finallyLoc")&&this.prev<y.finallyLoc){var h=y;break}}h&&(c==="break"||c==="continue")&&h.tryLoc<=a&&a<=h.finallyLoc&&(h=null);var A=h?h.completion:{};return A.type=c,A.arg=a,h?(this.method="next",this.next=h.finallyLoc,x):this.complete(A)},complete:function(c,a){if(c.type==="throw")throw c.arg;return c.type==="break"||c.type==="continue"?this.next=c.arg:c.type==="return"?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):c.type==="normal"&&a&&(this.next=a),x},finish:function(c){for(var a=this.tryEntries.length-1;a>=0;--a){var u=this.tryEntries[a];if(u.finallyLoc===c)return this.complete(u.completion,u.afterLoc),J(u),x}},catch:function(c){for(var a=this.tryEntries.length-1;a>=0;--a){var u=this.tryEntries[a];if(u.tryLoc===c){var y=u.completion;if(y.type==="throw"){var h=y.arg;J(u)}return h}}throw new Error("illegal catch attempt")},delegateYield:function(c,a,u){return this.delegate={iterator:me(c),resultName:a,nextLoc:u},this.method==="next"&&(this.arg=n),x}},e}(typeof Fe=="object"?Fe.exports:{});try{regeneratorRuntime=ke}catch(e){typeof globalThis=="object"?globalThis.regeneratorRuntime=ke:Function("r","regeneratorRuntime = r")(ke)}});var ht=R((qr,mt)=>{mt.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}});var Le=R((Hr,vt)=>{var Ee=!1,gt=()=>{},ir=e=>{Ee=e},sr=e=>{gt=e},ar=(e,t)=>{gt({type:e,message:t}),Ee&&`${e}${t}`};vt.exports={logging:Ee,setLogging:ir,setCustomLogger:sr,log:ar}});var wt=R((Gr,bt)=>{var Q=0,Ce=0,yt=e=>{let[t,r,n]=e.split(":");return parseFloat(t)*60*60+parseFloat(r)*60+parseFloat(n)};bt.exports=(e,t)=>{if(typeof e=="string")if(e.startsWith("  Duration")){let r=e.split(", ")[0].split(": ")[1],n=yt(r);t({duration:n,ratio:Ce}),(Q===0||Q>n)&&(Q=n)}else if(e.startsWith("frame")||e.startsWith("size")){let r=e.split("time=")[1].split(" ")[0],n=yt(r);Ce=n/Q,t({ratio:Ce,time:n})}else e.startsWith("video:")&&(t({ratio:1}),Q=0)}});var Ft=R((Ir,kt)=>{kt.exports=(e,t)=>{let r=e._malloc(t.length*Uint32Array.BYTES_PER_ELEMENT);return t.forEach((n,s)=>{let o=e.lengthBytesUTF8(n)+1,d=e._malloc(o);e.stringToUTF8(n,d,o),e.setValue(r+Uint32Array.BYTES_PER_ELEMENT*s,d,"i32")}),[t.length,r]}});var fe=R((Se,Et)=>{(function(e,t){typeof define=="function"&&define.amd?define(t):typeof Se=="object"?Et.exports=t():e.resolveUrl=t()})(Se,function(){function e(){var t=arguments.length;if(t===0)throw new Error("resolveUrl requires at least one argument; got none.");var r=document.createElement("base");if(r.href=arguments[0],t===1)return r.href;var n=document.getElementsByTagName("head")[0];n.insertBefore(r,n.firstChild);for(var s=document.createElement("a"),o,d=1;d<t;d++)s.href=arguments[d],o=s.href,r.href=o;return n.removeChild(r),o}return e})});var xe=R((Wr,lr)=>{lr.exports={name:"@ffmpeg/ffmpeg",version:"0.10.1",description:"FFmpeg WebAssembly version",main:"src/index.js",types:"src/index.d.ts",directories:{example:"examples"},scripts:{start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js",prepublishOnly:"npm run build",lint:"eslint src",wait:"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},browser:{"./src/node/index.js":"./src/browser/index.js"},repository:{type:"git",url:"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},keywords:["ffmpeg","WebAssembly","video"],author:"Jerome Wu <jeromewus@gmail.com>",license:"MIT",bugs:{url:"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},engines:{node:">=12.16.1"},homepage:"https://github.com/ffmpegwasm/ffmpeg.wasm#readme",dependencies:{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},devDependencies:{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.10.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0",chai:"^4.2.0",cors:"^2.8.5",eslint:"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1",express:"^4.17.1",mocha:"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0",webpack:"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"}}});var Ct=R((Vr,Lt)=>{var zr=fe(),{devDependencies:cr}=xe();Lt.exports={corePath:`https://unpkg.com/@ffmpeg/core@${cr["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`}});var xt=R((Yr,St)=>{var ur=e=>`
createFFmpegCore is not defined. ffmpeg.wasm is unable to find createFFmpegCore after loading ffmpeg-core.js from ${e}. Use another URL when calling createFFmpeg():

const ffmpeg = createFFmpeg({
  corePath: 'http://localhost:3000/ffmpeg-core.js',
});
`;St.exports={CREATE_FFMPEG_CORE_IS_NOT_DEFINED:ur}});var At=R((Ae,Pt)=>{var fr=fe(),{log:X}=Le(),{CREATE_FFMPEG_CORE_IS_NOT_DEFINED:pr}=xt(),Pe=(e,t)=>$(Ae,null,function*(){X("info",`fetch ${e}`);let r=yield(yield fetch(e)).arrayBuffer();X("info",`${e} file size = ${r.byteLength} bytes`);let n=new Blob([r],{type:t}),s=URL.createObjectURL(n);return X("info",`${e} blob URL = ${s}`),s});Pt.exports=t=>$(Ae,[t],function*({corePath:e}){if(typeof e!="string")throw Error("corePath should be a string!");let r=fr(e),n=yield Pe(r,"application/javascript"),s=yield Pe(r.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),o=yield Pe(r.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore=="undefined"?new Promise(d=>{let m=document.createElement("script"),f=()=>{if(m.removeEventListener("load",f),typeof createFFmpegCore=="undefined")throw Error(pr(r));X("info","ffmpeg-core.js script loaded"),d({createFFmpegCore,corePath:n,wasmPath:s,workerPath:o})};m.src=n,m.type="text/javascript",m.addEventListener("load",f),document.getElementsByTagName("head")[0].appendChild(m)}):(X("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:n,wasmPath:s,workerPath:o}))})});var Ot=R((jt,Ut)=>{var _r=fe(),dr=e=>new Promise((t,r)=>{let n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=({target:{error:{code:s}}})=>{r(Error(`File could not be read! Code=${s}`))},n.readAsArrayBuffer(e)});Ut.exports=e=>$(jt,null,function*(){let t=e;return typeof e=="undefined"?new Uint8Array:(typeof e=="string"?/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(r=>r.charCodeAt(0)):t=yield(yield fetch(_r(e))).arrayBuffer():(e instanceof File||e instanceof Blob)&&(t=yield dr(e)),new Uint8Array(t))})});var je=R((Jr,Tt)=>{var mr=Ct(),hr=At(),gr=Ot();Tt.exports={defaultOptions:mr,getCreateFFmpegCore:hr,fetchFile:gr}});var Mt=R((Bt,Nt)=>{var{defaultArgs:vr,baseOptions:yr}=ht(),{setLogging:Dt,setCustomLogger:Rt,log:V}=Le(),br=wt(),wr=Ft(),{defaultOptions:kr,getCreateFFmpegCore:Fr}=je(),{version:Er}=xe(),Ue=Error("ffmpeg.wasm is not ready, make sure you have completed load().");Nt.exports=(e={})=>{let U=H(H(H({},yr),kr),e),{log:t,logger:r,progress:n}=U,s=Ne(U,["log","logger","progress"]),o=null,d=null,m=null,f=!1,F=n,i=_=>{_==="FFMPEG_END"&&m!==null&&(m(),m=null,f=!1)},E=({type:_,message:k})=>{V(_,k),br(k,F),i(k)},v=()=>$(Bt,null,function*(){if(V("info","load ffmpeg-core"),o===null){V("info","loading ffmpeg-core");let{createFFmpegCore:_,corePath:k,workerPath:g,wasmPath:j}=yield Fr(s);o=yield _({mainScriptUrlOrBlob:k,printErr:C=>E({type:"fferr",message:C}),print:C=>E({type:"ffout",message:C}),locateFile:(C,B)=>{if(typeof window!="undefined"){if(typeof j!="undefined"&&C.endsWith("ffmpeg-core.wasm"))return j;if(typeof g!="undefined"&&C.endsWith("ffmpeg-core.worker.js"))return g}return B+C}}),d=o.cwrap("proxy_main","number",["number","number"]),V("info","ffmpeg-core loaded")}else throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.")}),p=()=>o!==null,b=(..._)=>{if(V("info",`run ffmpeg command: ${_.join(" ")}`),o===null)throw Ue;if(f)throw Error("ffmpeg.wasm can only run one command at a time");return f=!0,new Promise(k=>{let g=[...vr,..._].filter(j=>j.length!==0);m=k,d(...wr(o,g))})},x=(_,...k)=>{if(V("info",`run FS.${_} ${k.map(g=>typeof g=="string"?g:`<${g.length} bytes binary file>`).join(" ")}`),o===null)throw Ue;{let g=null;try{g=o.FS[_](...k)}catch(j){throw Error(_==="readdir"?`ffmpeg.FS('readdir', '${k[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:_==="readFile"?`ffmpeg.FS('readFile', '${k[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return g}},L=()=>{if(o===null)throw Ue;f=!1,o.exit(1),o=null,d=null,m=null},S=_=>{F=_},P=_=>{Rt(_)};return Dt(t),Rt(r),V("info",`use ffmpeg.wasm v${Er}`),{setProgress:S,setLogger:P,setLogging:Dt,load:v,isLoaded:p,run:b,exit:L,FS:x}}});var qt=R((Kr,$t)=>{dt();var Lr=Mt(),{fetchFile:Cr}=je();$t.exports={createFFmpeg:Lr,fetchFile:Cr}});var se,w,Ie,Kt,Z,We,Me,Zt,ne={},ze=[],Qt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function W(e,t){for(var r in t)e[r]=t[r];return e}function Ve(e){var t=e.parentNode;t&&t.removeChild(e)}function l(e,t,r){var n,s,o,d={};for(o in t)o=="key"?n=t[o]:o=="ref"?s=t[o]:d[o]=t[o];if(arguments.length>2&&(d.children=arguments.length>3?se.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)d[o]===void 0&&(d[o]=e.defaultProps[o]);return te(e,d,n,s,null)}function te(e,t,r,n,s){var o={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s==null?++Ie:s};return s==null&&w.vnode!=null&&w.vnode(o),o}function ae(e){return e.children}function re(e,t){this.props=e,this.context=t}function Y(e,t){if(t==null)return e.__?Y(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?Y(e):null}function Ye(e){var t,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return Ye(e)}}function $e(e){(!e.__d&&(e.__d=!0)&&Z.push(e)&&!oe.__r++||Me!==w.debounceRendering)&&((Me=w.debounceRendering)||We)(oe)}function oe(){for(var e;oe.__r=Z.length;)e=Z.sort(function(t,r){return t.__v.__b-r.__v.__b}),Z=[],e.some(function(t){var r,n,s,o,d,m;t.__d&&(d=(o=(r=t).__v).__e,(m=r.__P)&&(n=[],(s=W({},o)).__v=o.__v+1,ye(m,o,s,r.__n,m.ownerSVGElement!==void 0,o.__h!=null?[d]:null,n,d==null?Y(o):d,o.__h),Qe(n,o),o.__e!=d&&Ye(o)))})}function Je(e,t,r,n,s,o,d,m,f,F){var i,E,v,p,b,x,L,S=n&&n.__k||ze,P=S.length;for(r.__k=[],i=0;i<t.length;i++)if((p=r.__k[i]=(p=t[i])==null||typeof p=="boolean"?null:typeof p=="string"||typeof p=="number"||typeof p=="bigint"?te(null,p,null,null,p):Array.isArray(p)?te(ae,{children:p},null,null,null):p.__b>0?te(p.type,p.props,p.key,null,p.__v):p)!=null){if(p.__=r,p.__b=r.__b+1,(v=S[i])===null||v&&p.key==v.key&&p.type===v.type)S[i]=void 0;else for(E=0;E<P;E++){if((v=S[E])&&p.key==v.key&&p.type===v.type){S[E]=void 0;break}v=null}ye(e,p,v=v||ne,s,o,d,m,f,F),b=p.__e,(E=p.ref)&&v.ref!=E&&(L||(L=[]),v.ref&&L.push(v.ref,null,p),L.push(E,p.__c||b,p)),b!=null?(x==null&&(x=b),typeof p.type=="function"&&p.__k===v.__k?p.__d=f=Ke(p,f,e):f=Ze(e,p,v,S,b,f),typeof r.type=="function"&&(r.__d=f)):f&&v.__e==f&&f.parentNode!=e&&(f=Y(v))}for(r.__e=x,i=P;i--;)S[i]!=null&&(typeof r.type=="function"&&S[i].__e!=null&&S[i].__e==r.__d&&(r.__d=Y(n,i+1)),et(S[i],S[i]));if(L)for(i=0;i<L.length;i++)Xe(L[i],L[++i],L[++i])}function Ke(e,t,r){for(var n,s=e.__k,o=0;s&&o<s.length;o++)(n=s[o])&&(n.__=e,t=typeof n.type=="function"?Ke(n,t,r):Ze(r,n,n,s,n.__e,t));return t}function Ze(e,t,r,n,s,o){var d,m,f;if(t.__d!==void 0)d=t.__d,t.__d=void 0;else if(r==null||s!=o||s.parentNode==null)e:if(o==null||o.parentNode!==e)e.appendChild(s),d=null;else{for(m=o,f=0;(m=m.nextSibling)&&f<n.length;f+=2)if(m==s)break e;e.insertBefore(s,o),d=o}return d!==void 0?d:s.nextSibling}function Xt(e,t,r,n,s){var o;for(o in r)o==="children"||o==="key"||o in t||ie(e,o,null,r[o],n);for(o in t)s&&typeof t[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||r[o]===t[o]||ie(e,o,t[o],r[o],n)}function qe(e,t,r){t[0]==="-"?e.setProperty(t,r):e[t]=r==null?"":typeof r!="number"||Qt.test(t)?r:r+"px"}function ie(e,t,r,n,s){var o;e:if(t==="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||qe(e.style,t,"");if(r)for(t in r)n&&r[t]===n[t]||qe(e.style,t,r[t])}else if(t[0]==="o"&&t[1]==="n")o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=r,r?n||e.addEventListener(t,o?Ge:He,o):e.removeEventListener(t,o?Ge:He,o);else if(t!=="dangerouslySetInnerHTML"){if(s)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=r==null?"":r;break e}catch(d){}typeof r=="function"||(r!=null&&(r!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,r):e.removeAttribute(t))}}function He(e){this.l[e.type+!1](w.event?w.event(e):e)}function Ge(e){this.l[e.type+!0](w.event?w.event(e):e)}function ye(e,t,r,n,s,o,d,m,f){var F,i,E,v,p,b,x,L,S,P,U,_=t.type;if(t.constructor!==void 0)return null;r.__h!=null&&(f=r.__h,m=t.__e=r.__e,t.__h=null,o=[m]),(F=w.__b)&&F(t);try{e:if(typeof _=="function"){if(L=t.props,S=(F=_.contextType)&&n[F.__c],P=F?S?S.props.value:F.__:n,r.__c?x=(i=t.__c=r.__c).__=i.__E:("prototype"in _&&_.prototype.render?t.__c=i=new _(L,P):(t.__c=i=new re(L,P),i.constructor=_,i.render=tr),S&&S.sub(i),i.props=L,i.state||(i.state={}),i.context=P,i.__n=n,E=i.__d=!0,i.__h=[]),i.__s==null&&(i.__s=i.state),_.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=W({},i.__s)),W(i.__s,_.getDerivedStateFromProps(L,i.__s))),v=i.props,p=i.state,E)_.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(_.getDerivedStateFromProps==null&&L!==v&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(L,P),!i.__e&&i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(L,i.__s,P)===!1||t.__v===r.__v){i.props=L,i.state=i.__s,t.__v!==r.__v&&(i.__d=!1),i.__v=t,t.__e=r.__e,t.__k=r.__k,t.__k.forEach(function(k){k&&(k.__=t)}),i.__h.length&&d.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(L,i.__s,P),i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(v,p,b)})}i.context=P,i.props=L,i.state=i.__s,(F=w.__r)&&F(t),i.__d=!1,i.__v=t,i.__P=e,F=i.render(i.props,i.state,i.context),i.state=i.__s,i.getChildContext!=null&&(n=W(W({},n),i.getChildContext())),E||i.getSnapshotBeforeUpdate==null||(b=i.getSnapshotBeforeUpdate(v,p)),U=F!=null&&F.type===ae&&F.key==null?F.props.children:F,Je(e,Array.isArray(U)?U:[U],t,r,n,s,o,d,m,f),i.base=t.__e,t.__h=null,i.__h.length&&d.push(i),x&&(i.__E=i.__=null),i.__e=!1}else o==null&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=er(r.__e,t,r,n,s,o,d,f);(F=w.diffed)&&F(t)}catch(k){t.__v=null,(f||o!=null)&&(t.__e=m,t.__h=!!f,o[o.indexOf(m)]=null),w.__e(k,t,r)}}function Qe(e,t){w.__c&&w.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(n){n.call(r)})}catch(n){w.__e(n,r.__v)}})}function er(e,t,r,n,s,o,d,m){var f,F,i,E=r.props,v=t.props,p=t.type,b=0;if(p==="svg"&&(s=!0),o!=null){for(;b<o.length;b++)if((f=o[b])&&"setAttribute"in f==!!p&&(p?f.localName===p:f.nodeType===3)){e=f,o[b]=null;break}}if(e==null){if(p===null)return document.createTextNode(v);e=s?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,v.is&&v),o=null,m=!1}if(p===null)E===v||m&&e.data===v||(e.data=v);else{if(o=o&&se.call(e.childNodes),F=(E=r.props||ne).dangerouslySetInnerHTML,i=v.dangerouslySetInnerHTML,!m){if(o!=null)for(E={},b=0;b<e.attributes.length;b++)E[e.attributes[b].name]=e.attributes[b].value;(i||F)&&(i&&(F&&i.__html==F.__html||i.__html===e.innerHTML)||(e.innerHTML=i&&i.__html||""))}if(Xt(e,v,E,s,m),i)t.__k=[];else if(b=t.props.children,Je(e,Array.isArray(b)?b:[b],t,r,n,s&&p!=="foreignObject",o,d,o?o[0]:r.__k&&Y(r,0),m),o!=null)for(b=o.length;b--;)o[b]!=null&&Ve(o[b]);m||("value"in v&&(b=v.value)!==void 0&&(b!==e.value||p==="progress"&&!b||p==="option"&&b!==E.value)&&ie(e,"value",b,E.value,!1),"checked"in v&&(b=v.checked)!==void 0&&b!==e.checked&&ie(e,"checked",b,E.checked,!1))}return e}function Xe(e,t,r){try{typeof e=="function"?e(t):e.current=t}catch(n){w.__e(n,r)}}function et(e,t,r){var n,s;if(w.unmount&&w.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||Xe(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){w.__e(o,t)}n.base=n.__P=null}if(n=e.__k)for(s=0;s<n.length;s++)n[s]&&et(n[s],t,typeof e.type!="function");r||e.__e==null||Ve(e.__e),e.__e=e.__d=void 0}function tr(e,t,r){return this.constructor(e,r)}function tt(e,t,r){var n,s,o;w.__&&w.__(e,t),s=(n=typeof r=="function")?null:r&&r.__k||t.__k,o=[],ye(t,e=(!n&&r||t).__k=l(ae,null,[e]),s||ne,ne,t.ownerSVGElement!==void 0,!n&&r?[r]:s?null:t.firstChild?se.call(t.childNodes):null,o,!n&&r?r:s?s.__e:t.firstChild,n),Qe(o,e)}se=ze.slice,w={__e:function(e,t,r,n){for(var s,o,d;t=t.__;)if((s=t.__c)&&!s.__)try{if((o=s.constructor)&&o.getDerivedStateFromError!=null&&(s.setState(o.getDerivedStateFromError(e)),d=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(e,n||{}),d=s.__d),d)return s.__E=s}catch(m){e=m}throw e}},Ie=0,Kt=function(e){return e!=null&&e.constructor===void 0},re.prototype.setState=function(e,t){var r;r=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=W({},this.state),typeof e=="function"&&(e=e(W({},r),this.props)),e&&W(r,e),e!=null&&this.__v&&(t&&this.__h.push(t),$e(this))},re.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),$e(this))},re.prototype.render=ae,Z=[],We=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,oe.__r=0,Zt=0;var ue,M,rt,ce=0,ct=[],nt=w.__b,ot=w.__r,it=w.diffed,st=w.__c,at=w.unmount;function we(e,t){w.__h&&w.__h(M,e,ce||t),ce=0;var r=M.__H||(M.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function G(e){return ce=1,rr(_t,e)}function rr(e,t,r){var n=we(ue++,2);return n.t=e,n.__c||(n.__=[r?r(t):_t(void 0,t),function(s){var o=n.t(n.__[0],s);n.__[0]!==o&&(n.__=[o,n.__[1]],n.__c.setState({}))}],n.__c=M),n.__}function ut(e,t){var r=we(ue++,3);!w.__s&&pt(r.__H,t)&&(r.__=e,r.__H=t,M.__H.__h.push(r))}function ft(e){return ce=5,nr(function(){return{current:e}},[])}function nr(e,t){var r=we(ue++,7);return pt(r.__H,t)&&(r.__=e(),r.__H=t,r.__h=e),r.__}function or(){for(var e;e=ct.shift();)if(e.__P)try{e.__H.__h.forEach(le),e.__H.__h.forEach(be),e.__H.__h=[]}catch(t){e.__H.__h=[],w.__e(t,e.__v)}}w.__b=function(e){M=null,nt&&nt(e)},w.__r=function(e){ot&&ot(e),ue=0;var t=(M=e.__c).__H;t&&(t.__h.forEach(le),t.__h.forEach(be),t.__h=[])},w.diffed=function(e){it&&it(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(ct.push(t)!==1&&rt===w.requestAnimationFrame||((rt=w.requestAnimationFrame)||function(r){var n,s=function(){clearTimeout(o),lt&&cancelAnimationFrame(n),setTimeout(r)},o=setTimeout(s,100);lt&&(n=requestAnimationFrame(s))})(or)),M=null},w.__c=function(e,t){t.some(function(r){try{r.__h.forEach(le),r.__h=r.__h.filter(function(n){return!n.__||be(n)})}catch(n){t.some(function(s){s.__h&&(s.__h=[])}),t=[],w.__e(n,r.__v)}}),st&&st(e,t)},w.unmount=function(e){at&&at(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{le(n)}catch(s){t=s}}),t&&w.__e(t,r.__v))};var lt=typeof requestAnimationFrame=="function";function le(e){var t=M,r=e.__c;typeof r=="function"&&(e.__c=void 0,r()),M=t}function be(e){var t=M;e.__c=e.__(),M=t}function pt(e,t){return!e||e.length!==t.length||t.some(function(r,n){return r!==e[n]})}function _t(e,t){return typeof t=="function"?t(e):t}var pe=Jt(qt()),q=(0,pe.createFFmpeg)({corePath:"./ffmpeg-core.js",log:!0});function Sr(){let[e,t]=G(!0),[r,n]=G(0),[s,o]=G(""),[d,m]=G([]),[f,F]=G({}),[i,E]=G("output.mp4"),[v,p]=G(["-i","v.mp4","-i","a.aac","-c:v","copy","-c:a","copy"]),[b,x]=G([]);ut(()=>{$(this,null,function*(){q.setProgress(k=>{let{ratio:g}=k;g>=0&&g<=1&&n(g*100),g===1&&setTimeout(()=>{n(0)},1e3)}),q.setLogger(({type:k,message:g})=>{switch(k){case"fferr":m(j=>[...j,g]);return}}),o("Loading FFmpeg.wasm, may take few minutes");let _=Date.now();yield q.load(),o(`Loaded FFmpeg.wasm in ${Date.now()-_} ms`),t(!1)})},[]);let L=_=>$(this,null,function*(){o("Loading file, may take some times...");let k=Date.now(),{target:{files:g}}=_,j=[];for(let C=0;C<g.length;C++){let B=g[C],{name:I,size:_e,type:J}=B;q.FS("writeFile",I,yield(0,pe.fetchFile)(B)),j[I]={name:I,size:_e,type:J,fd:B}}o(`Loaded files in ${Date.now()-k} ms`),F(C=>H(H({},C),j))}),S=_=>$(this,null,function*(){o("Loading FFmpeg.wasm"),q.isLoaded()||(o("Loading ffmpeg.wasm-core, may take few minutes"),yield q.load()),o("Start to run command");let k=Date.now(),g=i;yield q.run(...v,g),o(`Done in ${Date.now()-k} ms`);let j=q.FS("readFile",g);x(C=>{let B=URL.createObjectURL(new Blob([j.buffer],{type:"video/mp4"}));return q.FS("unlink",g),[...C,{f:g,blob:B}]})}),P=_=>{Object.keys(f).filter(g=>f[g].rm).forEach(g=>{q.FS("unlink",f[g].name),delete f[g]}),F(g=>H({},g))},U=ft(null);return l("section",{class:"section"},l("h1",{class:"title"},"FFmpeg cli online"),l("p",{class:"subtitle"},"client-side-only FFmpeg power by ",l("a",{href:"https://ffmpegwasm.netlify.app/",target:"_blank",rel:"noopener"},"ffmpeg.wasm")),l("a",{class:"button is-large is-rounded is-dark",style:"position: absolute;right: 1rem;top: 1rem;",title:"GitHub repo",href:"https://github.com/cs8425/ffmpeg-cli-online",target:"_blank"},l("span",{class:"icon is-medium"},l("i",{class:"fab fa-github"}))),l("hr",null),l("div",{class:"block"},l(Oe,{header:"ffmpeg command"},l("textarea",{class:"textarea is-info",placeholder:"$ ffmpeg ...",readOnly:!0,rows:2},"ffmpeg ",v.join(" ")," ",i)),l(Oe,{header:"args:"},l("div",{class:"field is-grouped is-grouped-multiline"},v.map((_,k)=>l(xr,{argv:v,idx:k,onDel:()=>{p(C=>C.filter((B,I)=>I!==k))},onUpdate:()=>{p(C=>[...C])}})),l("div",{class:"field has-addons mx-4"},l("div",{class:"control"},l("input",{ref:U,class:"input is-info",type:"text",placeholder:"args"})),l("div",{class:"control"},l("a",{class:"button is-info",onClick:()=>{if(!U.current)return;let _=U.current.value;_!==""&&(U.current.value="",p(k=>[...k,_]))}},l("span",{class:""},"Add")))),l("div",{class:"field has-addons mx-4",title:"output filename"},l("div",{class:"control"},l("a",{class:"button is-primary is-outlined is-static"},"output")),l("div",{class:"control"},l("input",{class:"input is-primary",type:"text",placeholder:"output.mp4",value:i,onBlur:_=>{E(_.target.value)}})))))),l("div",{class:"block"},l("nav",{class:"panel"},l("p",{class:"panel-heading"},"Files"),!e&&l("div",{class:"panel-tabs py-4"},l("div",{class:"field is-grouped is-grouped-centered is-expanded"},l("p",{class:"control"},l("div",{class:"file"},l("label",{class:"file-label"},l("input",{class:"file-input",type:"file",onChange:L,multiple:!0}),l("span",{class:"file-cta"},l("span",{class:"file-icon"},l("i",{class:"fas fa-upload"})),l("span",{class:"file-label"},"Choose files..."))))),l("p",{class:"control"},l("div",{class:"buttons"})))),e&&l("div",{class:"panel-block notification"},"Loading ffmpeg..."),Object.keys(f).map(_=>{let k=f[_],g=j=>{f[_].rm=j.target.checked,F(C=>H({},C))};return l(Pr,Be(H({},k),{updateFn:g}))}),Object.keys(f).length>0&&l("div",{class:"panel-block"},l("button",{class:"button is-success is-outlined is-fullwidth mr-3",onClick:S},"run"),l("button",{class:"button is-danger is-outlined ml-3",onClick:P,disabled:Object.keys(f).filter(_=>f[_].rm).length===0},"delete")))),s&&l("div",{class:"notification"},l("button",{class:"delete"}),s),l(Oe,{header:"stderr"},l("textarea",{class:"textarea is-link",placeholder:"stderr",readonly:!0},d.join(`
`))),r!=0&&l("progress",{class:"progress is-small",value:r,max:"100"},r,"%"),l("div",{class:"block"},l("div",{class:"columns is-flex-wrap-wrap"},b.map((_,k)=>{let g=j=>{URL.revokeObjectURL(_.blob),x(C=>C.filter(B=>B.blob!==_.blob))};return l(jr,{key:_,name:_.f,url:_.blob,closeFn:g})}))))}tt(l(Sr),document.getElementById("app"));function xr(e){let{argv:t,idx:r,onDel:n=()=>{},onUpdate:s=()=>{}}=e,o=d=>{t[r]=d.target.value};return l("div",{class:"field has-addons mx-4"},l("div",{class:"control"},l("a",{class:"button is-danger",onClick:n},l("span",{class:"delete"}))),l("div",{class:"control"},l("input",{class:"input",type:"text",placeholder:"args",value:t[r],onInput:o,onBlur:s})))}function Pr(e){let{name:t,size:r,type:n,fd:s,rm:o=!1,updateFn:d}=e;return l("label",{class:"panel-block is-justify-content-space-between"},l("div",{class:"level-left"},l("div",{class:"level-item"},l("input",{type:"checkbox",onChange:d,checked:o})),l("div",{class:"level-item"},t)),l("div",{class:"level-right"},l("p",{class:"level-item"},Ar(r))))}function Ar(e){let t="Bytes";return e>1024&&(e/=1024,t="KB"),e>1024&&(e/=1024,t="MB"),e>1024&&(e/=1024,t="GB"),`${e.toFixed(2)} ${t}`}function Oe(e){let{header:t,children:r,isExpand:n=!0}=e,[s,o]=G(n);return l("section",{class:"message"},l("div",{class:"message-header"},l("p",null,t),l("span",{class:"icon is-clickable",onClick:d=>o(m=>!m)},l("i",{class:`fas fa-angle-${s?"up":"down"}`,"aria-hidden":"true"}))),s&&l("div",{class:"message-body"},r))}function jr(e){let{children:t,name:r,url:n,closeFn:s=()=>{}}=e;return l("div",{class:"column is-half-tablet is-one-third-desktop is-one-quarter-widescreen"},l("div",{class:"card"},l("header",{class:"card-header"},l("p",{class:"card-header-title"},r),l("div",{class:"card-header-icon"},l("button",{class:"delete",onClick:s}))),l("div",{class:"card-image"},l("video",{style:"width: 100%;",src:n,controls:!0})),l("footer",{class:"card-footer"},l("p",{class:"card-footer-item"},l("a",{href:n,download:r,class:"button is-link is-outlined is-fullwidth"},"Download")))))}})();
